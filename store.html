<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>JINIHOME | Archive</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,500;0,700;1,500&display=swap" rel="stylesheet">

    <style>
        /* 1. CORE SETTINGS */
        * { margin: 0; padding: 0; box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        
        :root {
            --header-bg: #002fa7; 
            --header-text: #ffffff;
            --body-bg: #ffffff;
            --theme-purple: #6c5ce7; 
        }

        body {
            font-family: 'Manrope', sans-serif;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            background: var(--body-bg);
            color: #000;
        }

        .font-serif { font-family: 'Playfair Display', serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }

        /* 2. ZONES */
        .zone-header {
            background-color: var(--header-bg);
            color: var(--header-text);
            position: relative;
        }

        /* 3. MARQUEE */
        .marquee-strip {
            background: #000;
            color: #fff;
            padding: 12px 0;
            overflow: hidden;
            white-space: nowrap;
            position: relative;
            z-index: 20;
        }
        .marquee-content {
            display: inline-block;
            animation: marquee 20s linear infinite;
        }
        .marquee-item {
            display: inline-block;
            padding: 0 2rem;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.2em;
        }
        @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

        /* 4. COLLECTIONS */
        .collection-track-wrapper { width: 100%; }
        .collection-track {
            display: flex; gap: 2rem; overflow-x: auto; padding-bottom: 2rem;
            width: 100%; padding-left: 1.5rem; padding-right: 1.5rem;
            justify-content: center; 
        }
        @media (max-width: 600px) { .collection-track { justify-content: flex-start; } }

        .collection-circle {
            width: 110px; height: 110px;
            border-radius: 50%;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(0,0,0,0.05);
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        }
        @media (min-width: 768px) { 
            .collection-circle { width: 140px; height: 140px; }
        }

        .collection-item.active .collection-circle {
            border-color: #000; transform: scale(1.05); box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        .collection-item.active p { font-weight: 800; color: black; }

        /* 5. MODAL */
        #product-modal { transition: opacity 0.3s ease, visibility 0.3s; }
        .modal-card { transform: scale(0.98); opacity: 0; transition: all 0.4s cubic-bezier(0.19, 1, 0.22, 1); }
        #product-modal.open .modal-card { transform: scale(1); opacity: 1; }

        /* THE SWITCHER STYLING */
        .thumb-column-item {
            width: 100%; aspect-ratio: 3/4; border: 1px solid transparent; 
            cursor: pointer; transition: all 0.3s ease; opacity: 0.6;
            overflow: hidden;
        }
        .thumb-column-item.active { border-color: black; opacity: 1; }
        .thumb-column-item img { width: 100%; height: 100%; object-cover: cover; }

        .size-opt { 
            border: 1px solid #e5e5e5; color: #000; transition: all 0.2s;
        }
        .size-opt:hover { border-color: #000; }
        .size-opt.selected { background: #000; color: #fff; border-color: #000; }

        .color-opt { width: 20px; height: 20px; border-radius: 50%; border: 1px solid #e5e5e5; cursor: pointer; position: relative; }
        .color-opt.selected::after {
            content: ''; position: absolute; inset: -3px; border: 1px solid #000; border-radius: 50%;
        }

        /* 6. UTILS */
        .intro-curtain { position: fixed; inset: 0; z-index: 10000; background: #050505; flex-direction: column; justify-content: space-between; padding: 2rem; display: flex; }
        .float-anim { animation: float 6s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
    </style>
</head>

<body>

    <div id="intro-screen" class="intro-curtain">
        <div class="flex justify-between items-start w-full opacity-0 intro-reveal">
            <div><p class="text-[10px] uppercase tracking-widest text-white/50 mb-1">Origin</p><p id="intro-loc" class="text-xs text-white uppercase tracking-widest">Loading...</p></div>
            <div class="text-right"><p class="text-[10px] uppercase tracking-widest text-white/50 mb-1">Philosophy</p><p id="intro-desc" class="text-xs text-white/80 italic">Archive...</p></div>
        </div>
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-center w-full">
            <h1 id="intro-title" class="text-[12vw] font-bold tracking-tighter text-white opacity-0 uppercase mix-blend-difference">JINIHOME</h1>
        </div>
        <div class="w-full opacity-0 intro-reveal">
            <div class="h-[1px] w-full bg-white/20 relative"><div id="load-bar" class="absolute top-0 left-0 h-full w-0 bg-white"></div></div>
        </div>
    </div>

    <div id="app-content" style="opacity: 0;">
        
        <div class="zone-header">
            <nav class="fixed top-0 w-full z-50 px-6 h-24 flex justify-between items-center mix-blend-difference text-white">
                <div class="flex items-center gap-4">
                    <img id="nav-logo" src="" class="h-6 w-auto hidden brightness-0 invert">
                    <span id="nav-text" class="text-xl font-bold tracking-tighter uppercase">JINIHOME</span>
                </div>
                <button onclick="toggleCart()" class="flex items-center gap-3">
                    <span class="text-[10px] uppercase tracking-widest text-white hidden md:block">Bag</span>
                    <div id="cart-count" class="w-8 h-8 bg-white text-black flex items-center justify-center text-xs font-bold rounded-full">0</div>
                </button>
            </nav>

            <header class="min-h-[85vh] flex flex-row items-center justify-between px-6 md:px-24 pt-32 pb-20">
                <div class="w-1/2 z-10 pr-4">
                    <p class="text-[10px] uppercase tracking-widest text-white mb-6 border-l-2 border-white pl-4">Establishment 2026</p>
                    <h1 class="text-[9vw] md:text-[9vw] font-bold uppercase tracking-tighter leading-[0.8] mb-10">
                        Prime <br><span class="font-light italic opacity-60">Archive</span>
                    </h1>
                    <button onclick="document.getElementById('zone-shop').scrollIntoView({behavior:'smooth'})" class="bg-white text-black px-6 md:px-10 py-3 md:py-4 text-[9px] md:text-[10px] font-bold uppercase tracking-[0.3em] hover:bg-opacity-90 transition-all">
                        Enter Vault
                    </button>
                </div>
                <div class="w-1/2 flex justify-center">
                    <div class="w-full max-w-[450px] aspect-[3/4] border-2 border-white/20 relative overflow-hidden shadow-2xl float-anim rounded-t-full">
                        <img src="https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?q=80&w=1000" class="w-full h-full object-cover">
                    </div>
                </div>
            </header>
        </div>

        <div class="marquee-strip">
            <div class="marquee-content">
                <span class="marquee-item">New Arrivals</span><span class="marquee-item">•</span>
                <span class="marquee-item">Worldwide Shipping</span><span class="marquee-item">•</span>
                <span class="marquee-item">Authentic Archive</span><span class="marquee-item">•</span>
                <span class="marquee-item">Limited Edition</span><span class="marquee-item">•</span>
                <span class="marquee-item">New Arrivals</span><span class="marquee-item">•</span>
                <span class="marquee-item">Worldwide Shipping</span><span class="marquee-item">•</span>
            </div>
        </div>

        <div id="zone-shop" class="zone-body pt-16">
            <div class="mb-20">
                <div class="px-6 md:px-12 mb-10 flex justify-between items-end">
                    <h2 class="text-lg font-bold uppercase tracking-tight">Departments</h2>
                    <p class="text-[10px] uppercase tracking-widest text-black/40">Select Category</p>
                </div>
                <div class="collection-track-wrapper">
                    <div id="collection-track" class="collection-track no-scrollbar"></div>
                </div>
            </div>

            <div class="min-h-screen px-4 md:px-12 pb-32">
                <div class="mb-12 flex items-baseline justify-between border-b border-black/10 pb-4">
                    <h2 id="grid-title" class="text-3xl md:text-5xl font-serif font-medium tracking-tight">All Items</h2>
                    <p id="grid-count" class="text-[10px] uppercase tracking-widest font-bold">Loading...</p>
                </div>
                <div id="product-grid" class="grid grid-cols-2 md:grid-cols-4 gap-x-4 gap-y-12 md:gap-x-8 md:gap-y-16"></div>
            </div>

            <footer class="py-24 text-center opacity-50 border-t border-gray-100">
                <h2 id="footer-logo" class="text-[12vw] font-bold tracking-tighter uppercase opacity-20">JINIHOME</h2>
                <p class="text-[10px] uppercase tracking-widest mt-8">© 2026 Global Archive System</p>
            </footer>
        </div>
    </div>

    <div id="product-modal" class="fixed inset-0 z-[200] invisible opacity-0 flex items-center justify-center pointer-events-none">
        <div class="absolute inset-0 bg-black/40 backdrop-blur-sm pointer-events-auto transition-opacity" onclick="closeModal()"></div>
        
        <div class="modal-card w-full h-full md:h-[85vh] md:w-[90vw] md:max-w-5xl bg-white md:rounded-xl shadow-2xl relative pointer-events-auto overflow-hidden flex flex-col">
            
            <button onclick="closeModal()" class="absolute top-4 right-4 z-50 w-10 h-10 bg-white/80 backdrop-blur rounded-full flex items-center justify-center hover:bg-black hover:text-white transition-colors">✕</button>

            <div class="flex-1 overflow-hidden">
                <div class="flex flex-col md:flex-row h-full">
                    
                    <div class="w-full md:w-[60%] flex h-[50vh] md:h-full bg-gray-50 p-4 gap-4">
                        <div id="thumb-column" class="w-20 md:w-24 flex flex-col gap-3 overflow-y-auto no-scrollbar h-full">
                            </div>

                        <div class="flex-1 h-full bg-white relative overflow-hidden group">
                            <img id="main-display-img" src="" class="w-full h-full object-cover transition-all duration-500">
                        </div>
                    </div>

                    <div class="w-full md:w-[40%] bg-white h-full overflow-y-auto border-l border-gray-100">
                        <div class="p-6 md:p-10 flex flex-col min-h-full">
                            
                            <div class="mb-2">
                                <span class="text-[10px] font-bold uppercase tracking-[0.2em] text-gray-400">Archive Collection</span>
                            </div>

                            <h2 id="modal-name" class="font-serif text-3xl mb-4 text-black">Product Name</h2>
                            <p id="modal-price" class="text-2xl font-mono text-gray-900 mb-8">₹0</p>

                            <div class="mb-8 border-t border-gray-100 pt-6">
                                <p id="modal-desc" class="text-sm text-gray-600 leading-relaxed font-light">Loading...</p>
                            </div>

                            <div class="space-y-6 mb-10">
                                <div>
                                    <span class="text-[10px] font-bold uppercase tracking-widest mb-3 block">Color</span>
                                    <div class="flex gap-3">
                                        <div class="color-opt bg-black selected"></div>
                                        <div class="color-opt bg-gray-400"></div>
                                        <div class="color-opt bg-blue-900"></div>
                                    </div>
                                </div>
                                <div>
                                    <span class="text-[10px] font-bold uppercase tracking-widest mb-3 block">Size</span>
                                    <div class="grid grid-cols-4 gap-2" id="size-container">
                                        <button class="size-opt h-10 text-xs font-medium flex items-center justify-center" onclick="selectSize(this)">S</button>
                                        <button class="size-opt h-10 text-xs font-medium flex items-center justify-center selected" onclick="selectSize(this)">M</button>
                                        <button class="size-opt h-10 text-xs font-medium flex items-center justify-center" onclick="selectSize(this)">L</button>
                                        <button class="size-opt h-10 text-xs font-medium flex items-center justify-center" onclick="selectSize(this)">XL</button>
                                    </div>
                                </div>
                            </div>

                            <div class="mt-auto space-y-3 pt-6 border-t border-gray-100">
                                <button onclick="addToCartFromModal()" class="w-full py-4 border border-black text-black font-bold uppercase tracking-[0.2em] text-xs hover:bg-black hover:text-white transition-all">Add to Bag</button>
                                <button onclick="buyNowFromModal()" class="w-full py-4 bg-[#002fa7] text-white font-bold uppercase tracking-[0.2em] text-xs hover:opacity-90 transition-opacity">Buy Now</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="cart-sidebar" class="fixed inset-y-0 right-0 w-full md:w-[450px] bg-white z-[300] transform translate-x-full transition-transform duration-500 border-l border-gray-100 flex flex-col shadow-2xl">
        <div class="p-8 flex justify-between items-center border-b border-black/5 bg-gray-50">
            <h3 class="font-bold text-xl uppercase tracking-tighter">Your Bag</h3>
            <button onclick="toggleCart()" class="text-2xl">✕</button>
        </div>
        <div id="cart-items" class="flex-1 overflow-y-auto p-8 space-y-6"></div>
        <div class="p-8 border-t border-black/5">
            <div class="flex justify-between text-xl font-bold mb-6"><span>Total</span><span id="cart-total">₹0.00</span></div>
            <button onclick="checkoutWhatsApp()" class="w-full py-6 bg-black text-white font-bold uppercase tracking-[0.3em]">Checkout</button>
        </div>
    </div>

    <script>
        const SUPABASE_URL = 'https://rujozgysdnaxlpqadqff.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ1am96Z3lzZG5heGxwcWFkcWZmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk0OTY1MTUsImV4cCI6MjA4NTA3MjUxNX0.zi4FwC0xfq0brTrYs3i18rwO3hbFeVhDBq6TpLQCyVs';
        const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        let products = [], collections = [], cart = [], profile = {};
        let collectionMap = {};
        let currentModalProduct = null;
        let selectedSize = 'M';

        const DEMO_PRODUCTS = [
            { id: 101, name: "Archive Racer Jkt", price: 4500, category: "Jackets", images: ["https://images.unsplash.com/photo-1559551409-dadc959f76b8?q=80&w=600", "https://images.unsplash.com/photo-1520975954732-35dd22299614?q=80&w=600", "https://images.unsplash.com/photo-1551488852-080175d6797c?q=80&w=600", "https://images.unsplash.com/photo-1515886657613-9f3515b0c78f?q=80&w=600"], description: "A rare archival piece featuring heavyweight vintage leather finish. Sourced from 2005 collection." },
            { id: 102, name: "Distressed Denim", price: 2800, category: "Bottoms", images: ["https://images.unsplash.com/photo-1541099649105-f69ad21f3246?q=80&w=600"], description: "Hand distressed cotton denim with custom hardware details." },
            { id: 103, name: "Oversized Hoodie", price: 3200, category: "Tops", images: ["https://images.unsplash.com/photo-1556906781-9a412961d28c?q=80&w=600"], description: "400GSM heavy cotton fleece. Drop shoulder fit." },
            { id: 104, name: "Chrome Pendant", price: 1500, category: "Accessories", images: ["https://images.unsplash.com/photo-1611085583191-a3b181a88401?q=80&w=600"], description: "Stainless steel hardware. Anti-tarnish coating." }
        ];

        window.onload = async () => {
            await syncDatabase();
            playIntro();
        };

        async function syncDatabase() {
            try {
                const path = window.location.pathname.replace(/\/+$/, '').split('/').pop();
                let slug = 'yashus'; 
                if(path && path !== 'index' && path !== 'store' && path !== 'null') slug = path;

                const { data: prof } = await sb.from('profiles').select('*').eq('store_slug', slug).maybeSingle();
                if(prof) {
                    profile = prof;
                    applyDesign();
                    const { data: prods } = await sb.from('products').select('*').eq('user_id', profile.id).order('created_at', {ascending: false});
                    products = prods || [];
                }

                if (!products || products.length === 0) products = DEMO_PRODUCTS;

                const { data: cols } = await sb.from('collections').select('*').order('name');
                collections = cols || [];
                collections.forEach(c => { if(c.id) collectionMap[c.id] = c.name; });
                
                if(collections.length === 0) {
                    collections = [
                        { name: "Jackets", img_url: "https://images.unsplash.com/photo-1559551409-dadc959f76b8?q=80&w=300" },
                        { name: "Bottoms", img_url: "https://images.unsplash.com/photo-1541099649105-f69ad21f3246?q=80&w=300" },
                        { name: "Tops", img_url: "https://images.unsplash.com/photo-1556906781-9a412961d28c?q=80&w=300" }
                    ];
                }

                renderCollections();
                filterGrid('All');

            } catch(e) { 
                console.error("Sync Error:", e); 
                products = DEMO_PRODUCTS;
                renderCollections();
                filterGrid('All');
                document.getElementById('app-content').style.opacity = 1; 
            }
        }

        function applyDesign() {
            const root = document.documentElement;
            const hColor = profile.header_color || '#002fa7';
            root.style.setProperty('--header-bg', hColor);
            const bColor = profile.body_color || '#ccff00';
            root.style.setProperty('--body-vignette', bColor);

            const name = profile.store_name || "ARCHIVE";
            document.querySelectorAll('#nav-text, #intro-title, #footer-logo').forEach(el => el.innerText = name);
            if(profile.logo_url) {
                document.getElementById('nav-logo').src = profile.logo_url;
                document.getElementById('nav-logo').classList.remove('hidden');
            }
        }

        function renderCollections() {
            const track = document.getElementById('collection-track');
            let html = `
                <div class="collection-item active shrink-0 text-center cursor-pointer group" onclick="filterGrid('All', this)">
                    <div class="collection-circle flex items-center justify-center bg-black text-white mb-4 mx-auto shadow-md">
                        <span class="font-bold text-sm tracking-widest">ALL</span>
                    </div>
                    <p class="text-xs font-bold uppercase tracking-widest text-black">All</p>
                </div>`;
            html += collections.map(c => {
                const safeName = c.name.replace(/'/g, "\\'");
                return `
                <div class="collection-item shrink-0 text-center cursor-pointer group" onclick="filterGrid('${safeName}', this)">
                    <div class="collection-circle overflow-hidden mb-4 mx-auto bg-white shadow-sm border border-gray-100 relative">
                        <img src="${c.img_url}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" onerror="this.src='https://placehold.co/300?text=${c.name}'">
                    </div>
                    <p class="text-xs uppercase tracking-widest text-gray-400 group-hover:text-black transition-colors">${c.name}</p>
                </div>
            `}).join('');
            track.innerHTML = html;
        }

        function filterGrid(categoryName, element) {
            if(element) {
                document.querySelectorAll('.collection-item').forEach(el => {
                    el.classList.remove('active');
                    el.querySelector('p').classList.replace('text-black', 'text-gray-400');
                    el.querySelector('p').classList.remove('font-bold');
                });
                element.classList.add('active');
                element.querySelector('p').classList.replace('text-gray-400', 'text-black');
                element.querySelector('p').classList.add('font-bold');
            }

            const target = categoryName.toLowerCase().trim();
            const filtered = target === 'all' ? products : products.filter(p => {
                const textValues = [p.collections, p.collection, p.category, p.categories, p.tags].flat().filter(v => v);
                const hasTextMatch = textValues.some(val => String(val).toLowerCase().trim() === target);
                if(hasTextMatch) return true;
                const idValues = [p.collection_id, p.category_id, p.collection].flat().filter(v => v);
                return idValues.some(id => (collectionMap[id] && collectionMap[id].toLowerCase().trim() === target));
            });

            document.getElementById('grid-title').innerText = categoryName === 'All' ? 'All Items' : categoryName;
            document.getElementById('grid-count').innerText = `(${filtered.length})`;

            const grid = document.getElementById('product-grid');
            if(filtered.length === 0) {
                grid.innerHTML = `<div class="col-span-full py-20 text-center text-xs uppercase tracking-widest text-gray-400">No items found</div>`;
                return;
            }

            grid.innerHTML = filtered.map(p => `
                <div class="group cursor-pointer flex flex-col gap-4" onclick="openModal('${p.id}')">
                    <div class="w-full aspect-[3/4] bg-gray-100 relative overflow-hidden">
                        <img src="${p.images ? p.images[0] : ''}" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                    </div>
                    <div class="flex justify-between items-start mb-1">
                        <h4 class="font-bold text-sm uppercase tracking-tight text-black line-clamp-1">${p.name}</h4>
                        <span class="font-mono text-sm text-black">₹${p.price}</span>
                    </div>
                </div>
            `).join('');

            gsap.fromTo(".group", { y: 30, opacity: 0 }, { y: 0, opacity: 1, duration: 0.6, stagger: 0.05, ease: "power2.out" });
        }

        // --- UPDATED MODAL LOGIC WITH VERTICAL THUMBS ---
        function openModal(productId) {
            const p = products.find(item => item.id == productId);
            if(!p) return;

            currentModalProduct = p;
            selectedSize = 'M';
            document.getElementById('modal-name').innerText = p.name;
            document.getElementById('modal-price').innerText = '₹' + p.price;
            document.getElementById('modal-desc').innerText = p.description || "Details unavailable.";
            
            const thumbColumn = document.getElementById('thumb-column');
            const mainImg = document.getElementById('main-display-img');
            const images = (p.images && p.images.length > 0) ? p.images : ['https://placehold.co/800x1000?text=No+Image'];
            
            // Set First Image as Main
            mainImg.src = images[0];

            // Render Max 4 Thumbnails
            thumbColumn.innerHTML = images.slice(0, 4).map((url, i) => `
                <div class="thumb-column-item ${i === 0 ? 'active' : ''}" onclick="switchModalImage('${url}', this)">
                    <img src="${url}">
                </div>
            `).join('');

            const modal = document.getElementById('product-modal');
            modal.style.visibility = 'visible';
            modal.style.opacity = '1';
            modal.classList.add('open');
            document.body.style.overflow = 'hidden';
        }

        function switchModalImage(url, el) {
            document.getElementById('main-display-img').src = url;
            document.querySelectorAll('.thumb-column-item').forEach(t => t.classList.remove('active'));
            el.classList.add('active');
        }

        function closeModal() {
            const modal = document.getElementById('product-modal');
            modal.classList.remove('open');
            modal.style.opacity = '0';
            setTimeout(() => { modal.style.visibility = 'hidden'; }, 300);
            document.body.style.overflow = '';
        }

        function selectSize(btn) {
            document.querySelectorAll('.size-opt').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            selectedSize = btn.innerText;
        }

        function addToCartFromModal() {
            if(currentModalProduct) { addToCart({...currentModalProduct, selectedSize: selectedSize}); closeModal(); }
        }

        function buyNowFromModal() {
            if(currentModalProduct) {
                const msg = `I would like to acquire: ${currentModalProduct.name} (Size: ${selectedSize}) - ₹${currentModalProduct.price}`;
                window.open(`https://wa.me/${profile.payment_number || '9199999999'}?text=${encodeURIComponent(msg)}`, '_blank');
            }
        }

        function playIntro() {
            const tl = gsap.timeline({ onComplete: () => { document.getElementById('app-content').style.opacity = 1; setTimeout(() => document.getElementById('intro-screen').style.display = 'none', 1000); }});
            tl.to(".intro-reveal", { opacity: 1, y: 0, duration: 1, stagger: 0.2 })
              .to("#load-bar", { width: "100%", duration: 1.5, ease: "power2.inOut" })
              .to("#intro-title", { opacity: 1, duration: 1 }, "-=1")
              .to("#intro-screen", { y: "-100%", duration: 1.2, ease: "expo.inOut", delay: 0.5 });
        }

        function addToCart(p) { cart.push(p); updateCart(); toggleCart(); }
        function updateCart() {
            const cont = document.getElementById('cart-items');
            let total = 0;
            cont.innerHTML = cart.map((item, i) => {
                total += parseFloat(item.price || 0);
                return `<div class="flex gap-4 border-b pb-4"><img src="${item.images[0]}" class="w-12 h-16 object-cover"><div class="flex-1"><p class="font-bold text-sm">${item.name} | ${item.selectedSize}</p><p class="text-xs text-gray-500">₹${item.price}</p><button onclick="cart.splice(${i},1);updateCart()" class="text-[9px] underline mt-1">REMOVE</button></div></div>`;
            }).join('');
            document.getElementById('cart-total').innerText = '₹' + total.toFixed(2);
            document.getElementById('cart-count').innerText = cart.length;
        }
        function toggleCart() { document.getElementById('cart-sidebar').classList.toggle('translate-x-full'); }
        function checkoutWhatsApp() { window.open(`https://wa.me/${profile.payment_number || '9199999999'}?text=Order:${cart.map(i=>`${i.name}(${i.selectedSize})`).join(', ')}`, '_blank'); }
    </script>
</body>
</html>
